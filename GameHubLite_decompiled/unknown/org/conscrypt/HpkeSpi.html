<!DOCTYPE html>
<html><head>
  <link rel="stylesheet" type="text/css" href="../../styles.css">
  <meta charset="UTF-8">
  <title>HpkeSpi - Conscrypt API</title>
</head>
<body><div class="package-name">
Package: org.conscrypt</div>
<h1>HpkeSpi</h1>
<pre class="class-signature">public interface HpkeSpi</pre><div class="class-description">
SPI for HPKE clients to communicate with implementations.  The client API can use any
 implementation which implements this interface, by duck-typing if necessary.</div>
<h2>Fields</h2>
<div class="member">
<h4>DEFAULT_PSK</h4>
</div>
<div class="member">
<h4>DEFAULT_PSK_ID</h4>
</div>
<h2>Public Methods</h2>
<div class="member">
<h4>engineInitSender</h4>
<pre class="method-signature">public abstract void engineInitSender(PublicKey recipientKey, byte[] info, PrivateKey senderKey, byte[] psk, byte[] psk_id) throws java.security.InvalidKeyException</pre><div class="description">
Initialises an HPKE sender SPI.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>recipientKey</td>
<td>public key of the recipient</td>
</tr>
<tr>
<td>info</td>
<td>application-supplied information, may be null or empty</td>
</tr>
<tr>
<td>senderKey</td>
<td>private key of the sender, for symmetric auth modes only, else null</td>
</tr>
<tr>
<td>psk</td>
<td>pre-shared key, for PSK auth modes only, else null</td>
</tr>
<tr>
<td>psk_id</td>
<td>pre-shared key ID, for PSK auth modes only, else null</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>InvalidKeyException</td>
<td>if recipientKey is null or an unsupported key format</td>
</tr>
<tr>
<td>UnsupportedOperationException</td>
<td>if mode is not a supported HPKE mode</td>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has already been initialised</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>engineInitSenderForTesting</h4>
<pre class="method-signature">public abstract void engineInitSenderForTesting(PublicKey recipientKey, byte[] info, PrivateKey senderKey, byte[] psk, byte[] psk_id, byte[] sKe) throws java.security.InvalidKeyException</pre><div class="description">
Initialises an HPKE sender SPI.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>recipientKey</td>
<td>public key of the recipient</td>
</tr>
<tr>
<td>info</td>
<td>application-supplied information, may be null or empty</td>
</tr>
<tr>
<td>senderKey</td>
<td>private key of the sender, for symmetric auth modes only, else null</td>
</tr>
<tr>
<td>psk</td>
<td>pre-shared key, for PSK auth modes only, else null</td>
</tr>
<tr>
<td>psk_id</td>
<td>pre-shared key ID, for PSK auth modes only, else null</td>
</tr>
<tr>
<td>sKe</td>
<td>optional random seed, should be null for all uses except for validation against
            known test vectors</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>InvalidKeyException</td>
<td>if recipientKey is null or an unsupported key format or senderKey
            is an unsupported key format</td>
</tr>
<tr>
<td>UnsupportedOperationException</td>
<td>if mode is not a supported HPKE mode</td>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has already been initialised</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>engineInitRecipient</h4>
<pre class="method-signature">public abstract void engineInitRecipient(byte[] encapsulated, PrivateKey recipientKey, byte[] info, PublicKey senderKey, byte[] psk, byte[] psk_id) throws java.security.InvalidKeyException</pre><div class="description">
Initialises an HPKE recipient SPI.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>encapsulated</td>
<td>encapsulated ephemeral key from a sender</td>
</tr>
<tr>
<td>recipientKey</td>
<td>private key of the recipient</td>
</tr>
<tr>
<td>info</td>
<td>application-supplied information, may be null or empty</td>
</tr>
<tr>
<td>senderKey</td>
<td>public key of sender, for asymmetric auth modes only, else null</td>
</tr>
<tr>
<td>psk</td>
<td>pre-shared key, for PSK auth modes only, else null</td>
</tr>
<tr>
<td>psk_id</td>
<td>pre-shared key ID, for PSK auth modes only, else null</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>InvalidKeyException</td>
<td>if recipientKey is null or an unsupported key format or senderKey
         is an unsupported key format</td>
</tr>
<tr>
<td>UnsupportedOperationException</td>
<td>if mode is not a supported HPKE mode</td>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has already been initialised</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>engineSeal</h4>
<pre class="method-signature">public abstract byte[] engineSeal(byte[] plaintext, byte[] aad)</pre><div class="description">
Seals a message, using the internal key schedule maintained by an HPKE sender.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>plaintext</td>
<td>the plaintext</td>
</tr>
<tr>
<td>aad</td>
<td>optional associated data, may be null or empty</td>
</tr>
<tr>
<th colspan="2"><strong>Returns</strong></th>
</tr>
<tr>
<td>byte[]</td>
<td>the ciphertext</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>NullPointerException</td>
<td>if the plaintext is null</td>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has not been initialised or if it was initialised
         as a recipient</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>engineOpen</h4>
<pre class="method-signature">public abstract byte[] engineOpen(byte[] ciphertext, byte[] aad) throws java.security.GeneralSecurityException</pre><div class="description">
Opens a message, using the internal key schedule maintained by an HPKE recipient.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>ciphertext</td>
<td>the ciphertext</td>
</tr>
<tr>
<td>aad</td>
<td>optional associated data, may be null or empty</td>
</tr>
<tr>
<th colspan="2"><strong>Returns</strong></th>
</tr>
<tr>
<td>byte[]</td>
<td>the plaintext</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has not been initialised or if it was initialised
         as a sender</td>
</tr>
<tr>
<td>GeneralSecurityException</td>
<td>on decryption failures</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>engineExport</h4>
<pre class="method-signature">public abstract byte[] engineExport(int length, byte[] context)</pre><div class="description">
Exports secret key material from this SPI as described in RFC 9180.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Parameters</strong></th>
</tr>
<tr>
<td>length</td>
<td>expected output length</td>
</tr>
<tr>
<td>context</td>
<td>optional context string, may be null or empty</td>
</tr>
<tr>
<th colspan="2"><strong>Returns</strong></th>
</tr>
<tr>
<td>byte[]</td>
<td>exported value</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>IllegalArgumentException</td>
<td>if the length is not valid for the KDF in use</td>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has not been initialised</td>
</tr>
</table>
</div>
</div>
</div>
<div class="member">
<h4>getEncapsulated</h4>
<pre class="method-signature">public abstract byte[] getEncapsulated()</pre><div class="description">
Returns the encapsulated key material for an HPKE sender.<div class="params">
<table class="params-table">
<tr>
<th colspan="2"><strong>Returns</strong></th>
</tr>
<tr>
<td>byte[]</td>
<td>the key material</td>
</tr>
<tr>
<th colspan="2"><strong>Throws</strong></th>
</tr>
<tr>
<td>IllegalStateException</td>
<td>if this SPI has not been initialised or if it was initialised
         as a recipient</td>
</tr>
</table>
</div>
</div>
</div>
</body></html>